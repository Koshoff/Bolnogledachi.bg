{% extends "fragments/base.html" %}

{% load static %}

{% block title %}–ö–æ–Ω—Ç–∞–∫—Ç–∏ | –ë–æ–ª–Ω–æ–≥–ª–µ–¥–∞—á–∏.–±–≥{% endblock %}

{% block content %}
<link rel="preload" as="image" href="{% static 'css/images/contact_page_hero_compressed.webp' %}">

<style>

  /* HERO */
.hero-contact {
  min-height: 55vh;
  background: linear-gradient(
                to right,
                rgba(0, 0, 0, 0.55),
                rgba(0, 0, 0, 0.2)
              ),
              url("{% static 'css/images/contact_page_hero_compressed.webp' %}") center/cover no-repeat;
  display: flex;
  align-items: flex-end;
  justify-content: flex-start;
  padding: 60px 80px;
  color: #fff;
}

.hero-contact h1 {
  font-size: 3.5rem;
  font-family: 'Oswald', sans-serif;
  margin: 0;
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* MAIN LAYOUT */
.contact-wrapper {
  display: flex;
  gap: 40px;
  max-width: 1200px;
  margin: 60px auto;
  align-items: stretch;
  justify-content: space-between;
}

#contact-form-container {
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
}

/* FORM */
.contact-form {
  flex: 1 1 60%;
  background: var(--light-blue);
  padding: 40px;
  border-radius: 14px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.08);
  display: flex;
  flex-direction: column;
  gap: 30px;
}

.contact-form label {
  font-weight: 600;
  margin-bottom: 6px;
  color: #222;
  font-size: 0.95rem;
}

.form-container {
  display: flex;
  gap: 25px;
}

.form-left,
.form-right {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 18px;
}

/* INPUTS & TEXTAREAS */
.contact-form input,
.contact-form select,
.contact-form textarea {
  padding: 12px 14px;
  border: 1px solid #ccc;
  border-radius: 8px;
  font-size: 1rem;
  transition: all 0.25s ease;
  background-color: #fdfdfd;
}

.contact-form input:focus,
.contact-form select:focus,
.contact-form textarea:focus {
  border-color: var(--primary-blue);
  box-shadow: 0 0 0 3px rgba(0,123,255,0.2);
  outline: none;
}

/* SUBMIT AREA */
.form-submit {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.form-submit .logo-text {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--primary-blue);
  text-decoration: none;
}

.form-submit button {
  padding: 12px 28px;
  background: var(--primary-blue);
  color: #fff;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.form-submit button:hover {
  background: #0056b3;
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

/* CONTACT INFO BOX */
.contact-info {
  flex: 1 1 35%;
  background: var(--light-blue);
  padding: 35px;
  border-radius: 14px;
  line-height: 1.6;
  box-shadow: 0 8px 24px rgba(0,0,0,0.08);
}

.contact-info h2 {
  font-size: 1.8rem;
  color: var(--text-dark);
  margin-bottom: 1rem;
}

.contact-info p {
  color: #555;
  font-size: 1rem;
  margin: 0.5rem 0;
}

/* MAP */
.map {
  max-width: 1200px;
  margin: 50px auto;
  border-radius: 14px;
  overflow: hidden;
  box-shadow: 0 6px 16px rgba(0,0,0,0.08);
}

/* THANK YOU MESSAGE */
.thank-you-message {
  background: #fff;
  padding: 3rem 2rem;
  border-radius: 14px;
  text-align: center;
  animation: fadeInUp 0.8s ease forwards;
}

.thank-you-message h2 {
  color: var(--primary-blue);
  font-size: 2rem;
  margin-bottom: 1rem;
  font-weight: 700;
}

.thank-you-message p {
  font-size: 1.1rem;
  color: #444;
}

.thank-you-message.error h2 {
  color: #b71c1c;
}

/* FADE EFFECTS */
.fade-out {
  opacity: 0;
  transition: opacity 0.6s ease;
}

.fade-in {
  opacity: 1;
  transition: opacity 0.6s ease;
}

@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(15px); }
  to { opacity: 1; transform: translateY(0); }
}

/* RESPONSIVE */
@media (max-width: 900px) {
  .contact-wrapper {
    flex-direction: column;
    padding: 0 20px;
  }

  .form-container {
    flex-direction: column;
  }

  .form-submit {
    flex-direction: column;
    gap: 1rem;
  }

  .hero-contact {
    padding: 40px 20px;
  }

  .hero-contact h1 {
    font-size: 2.5rem;
  }
}

</style>

<!-- Hero Section -->
{% load static %}

<section class="hero-contact">
    <h1>–ö–æ–Ω—Ç–∞–∫—Ç–∏</h1>
</section>



<!-- Contact Form + Info -->
<div class="contact-wrapper">

    <!-- Contact Form -->
    {% if messages %}
    <div class="messages-container">
      {% for m in messages %}
        <div class="message {{ m.tags }}">{{ m }}</div>
      {% endfor %}
    </div>
  {% endif %}

    {% comment %} 1 <form method="post" action="{% url 'contact_form' %}" class="contact-form">
    {% csrf_token %}
    {{ form.honeypot }}

    <div class="form-container">
        <div class="form-left">
            {{ form.name.errors }}
            {{ form.name }}

            {{ form.email.errors }}
            {{ form.email }}

            {{ form.phone.errors }}
            {{ form.phone }}

            {{ form.service.errors }}
            {{ form.service }}
        </div>

        <div class="form-right">
            {{ form.message.errors }}
            {{ form.message }}
            
            
        </div>
        
    </div> {% endcomment %}

      <div id="contact-form-container">
    <form id="contactForm" method="post" action="{% url 'contact_form' %}" class="contact-form" novalidate>
      {% csrf_token %}
      {{ form.honeypot }}

      <div class="form-container">
        <div class="form-left">
          <label for="{{ form.name.id_for_label }}"><strong>–ò–º–µ –∏ —Ñ–∞–º–∏–ª–∏—è</strong></label>
          {{ form.name }}

          <label for="{{ form.email.id_for_label }}"><strong>E-mail</strong></label>
          {{ form.email }}

          <label for="{{ form.phone.id_for_label }}"><strong>–¢–µ–ª–µ—Ñ–æ–Ω</strong></label>
          {{ form.phone }}

          <label for="{{ form.service.id_for_label }}"><strong>–£—Å–ª—É–≥–∞</strong></label>
          {{ form.service }}
        </div>

        <div class="form-right">
          <label for="{{ form.message.id_for_label }}"><strong>–í–∞—à–µ—Ç–æ –°—ä–æ–±—â–µ–Ω–∏–µ</strong></label>
          {{ form.message }}
        </div>
      </div>

      <div class="form-submit">
        <a href="{% url 'home' %}" class="logo-text">Bolnogledachi.bg</a>
        <button type="submit"><strong>–ò–∑–ø—Ä–∞—Ç–∏</strong></button>
      </div>
    </form>
  </div>

    {% if success %}
      <p class="success-message">‚úÖ –ë–ª–∞–≥–æ–¥–∞—Ä–∏–º! –°—ä–æ–±—â–µ–Ω–∏–µ—Ç–æ –±–µ—à–µ –∏–∑–ø—Ä–∞—Ç–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ.</p>
    {% elif error %}
      <p class="error-message">‚ùå –°—ä–∂–∞–ª—è–≤–∞–º–µ, –≤—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –∏–∑–ø—Ä–∞—â–∞–Ω–µ—Ç–æ. –ú–æ–ª—è, –æ–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ –ø–æ-–∫—ä—Å–Ω–æ.</p>
    {% endif %}

    <!-- Contact Info -->
    <div class="contact-info">
        <h2>–ù–∏–µ —Å–º–µ –¥–æ –≤–∞—Å</h2>
        <p><strong>–†–∞–±–æ—Ç–Ω–æ –≤—Ä–µ–º–µ:</strong><br> –ü–æ–Ω–µ–¥–µ–ª–Ω–∏–∫ - –ù–µ–¥–µ–ª—è 07:00 - 19:00</p>
        <p>üìû +359 87 8720988</p>
        <p>üìß contact@bolnogledachi.bg</p>
        <p>üìç –≥—Ä. –°–æ—Ñ–∏—è, –∫–≤. –ö–∏–Ω–æ—Ü–µ–Ω—Ç—ä—Ä, —É–ª. 206 –Ω–æ–º–µ—Ä 10</p>
        <p><em>–°—Ä–µ—â–∏ –≤ –æ—Ñ–∏—Å–∞ —Å–ª–µ–¥ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–æ —É–≥–æ–≤–æ—Ä–µ–Ω —á–∞—Å.</em></p>
    </div>

</div>

<!-- Google Maps -->
<div class="map">
    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2935.352585720258!2d23.293039976216818!3d42.63268471783412!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x40aa8384c4ba5309%3A0xa46e397e41c99e8f!2z0LIu0LcuINCa0LjQvdC-0YbQtdC90YLRitGA0LDQktC40YLQvtGI0LAsINGD0LsuIOKAnjIwNuKAnCAxMCwgMTQxNSDQodC-0YTQuNGP!5e0!3m2!1sbg!2sbg!4v1757594558757!5m2!1sbg!2sbg"
     width="100%" height="350" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
</div>

<style>
  .alert { padding: 10px; border-radius:6px; margin-bottom:10px; }
  .alert.success { background:#e6ffed; color:#1a7f37; }
  .alert.error { background:#ffe6e6; color:#a60303; }
  .field-error { color:#a60303; font-size:0.9rem; margin-top:6px; }

  
</style>



<script>
document.getElementById('contactForm').addEventListener('submit', async function (e) {
  e.preventDefault();

  const form = e.target;

  if (!form.checkValidity()) {
    form.reportValidity();
    return;
  }

  const formData = new FormData(form);
  const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
  const container = document.getElementById('contact-form-container');
  const originalHTML = container.innerHTML; // üíæ –ó–∞–ø–∞–∑–≤–∞–º–µ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∞—Ç–∞ —Ñ–æ—Ä–º–∞

  try {
    const response = await fetch(form.action, {
      method: 'POST',
      headers: { 'X-CSRFToken': csrfToken },
      body: formData
    });

    const data = await response.json();

    if (response.ok && data.success) {
      container.classList.add('fade-out');
      setTimeout(() => {
        container.innerHTML = `
          <div class="thank-you-message">
            <h2>–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –í–∏, —á–µ —Å–µ —Å–≤—ä—Ä–∑–∞—Ö—Ç–µ —Å –Ω–∞—Å!</h2>
            <p>–ù–∞—à –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª —â–µ —Å–µ —Å–≤—ä—Ä–∂–µ —Å –í–∞—Å –≤—ä–∑–º–æ–∂–Ω–æ –Ω–∞–π-—Å–∫–æ—Ä–æ.</p>
          </div>
        `;
        container.classList.remove('fade-out');
        container.classList.add('fade-in');
      }, 600);

    } else {
      const message = data.error || '–í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞. –ú–æ–ª—è, –æ–ø–∏—Ç–∞–π—Ç–µ –ø–æ-–∫—ä—Å–Ω–æ.';
      showError(container, message, originalHTML);
    }

  } catch (err) {
    console.error(err);
    showError(container, '–ù—è–º–∞ –≤—Ä—ä–∑–∫–∞ —Å—ä—Å —Å—ä—Ä–≤—ä—Ä–∞. –û–ø–∏—Ç–∞–π—Ç–µ –ø–∞–∫.', originalHTML);
  }
});

function showError(container, message, originalHTML) {
  container.classList.add('fade-out');
  setTimeout(() => {
    container.innerHTML = `
      <div class="thank-you-message error">
        <h2>–í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞!</h2>
        <p>${message}</p>
      </div>
    `;
    container.classList.remove('fade-out');
    container.classList.add('fade-in');

    // ‚è≥ –°–ª–µ–¥ 4 —Å–µ–∫—É–Ω–¥–∏ –≤—ä—Ä–Ω–∏ —Ñ–æ—Ä–º–∞—Ç–∞ –æ–±—Ä–∞—Ç–Ω–æ
    setTimeout(() => {
      container.classList.add('fade-out');
      setTimeout(() => {
        container.innerHTML = originalHTML;
        container.classList.remove('fade-out');
        container.classList.add('fade-in');
      }, 600);
    }, 4000); // <- –º–æ–∂–µ—à –¥–∞ –ø—Ä–æ–º–µ–Ω–∏—à –≤—Ä–µ–º–µ—Ç–æ (–≤ –º–∏–ª–∏—Å–µ–∫—É–Ω–¥–∏)
  }, 600);
}
</script>





{% endblock %}